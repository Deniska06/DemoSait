# –ü–µ—Ä–≤—ã–π —Å–∞–π—Ç –Ω–∞ Git.

#### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞. 

## –ó–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞—à–∞ —Ä–µ–∫–ª–∞–º–∞ =))

#### P/S

* –ó–≤–æ–Ω–∏—Ç–µ
* –ü–∏—à–∏—Ç–µ

#### –§–æ—Ç–æ—á–∫–∞

![](https://thumbs.dreamstime.com/b/cute-boy-licking-ice-cream-illustration-84830355.jpg)



–í–æ—Ç —Ä–µ—à–µ–Ω–∏–µ –≤–∞—à–µ–π –∑–∞–¥–∞—á–∏ –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∫ –Ω—É–∂–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π.

---

## ‚úÖ –ó–∞–¥–∞—á–∞:
1. –ü—Ä–∏–≤–µ—Å—Ç–∏ –§–ò–û –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∏–¥: `lastname`, `firstname`, `surname`.
2. –ü—Ä–∏–≤–µ—Å—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –∫ —Ñ–æ—Ä–º–∞—Ç—É: `+7(999)999-99-99` –∏–ª–∏ `+7(999)999-99-99 –¥–æ–±.9999`.
3. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã (–ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é **–§–∞–º–∏–ª–∏—è + –ò–º—è**).

---

## ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–¥:

```python
import re
import csv
from collections import defaultdict

# –í–∞—à —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
contacts = [
    ['lastname', 'firstname', 'surname', 'organization', 'position', 'phone', 'email'],
    ['–£—Å–æ–ª—å—Ü–µ–≤', '–û–ª–µ–≥', '–í–∞–ª–µ–Ω—Ç–∏–Ω–æ–≤–∏—á', '', '', '+7 (495) 913-04-78', 'opendata@nalog.ru'],
    ['–ú–∞—Ä—Ç–∏–Ω—è—Ö–∏–Ω', '–í–∏—Ç–∞–ª–∏–π', '–ì–µ–Ω–Ω–∞–¥—å–µ–≤–∏—á', '', '', '+749591300037', ''],
    ['–ù–∞—Ä–∫–∞–µ–≤', '–í—è—á–µ—Å–ª–∞–≤', '–†–∏—Ñ—Ö–∞—Ç–æ–≤–∏—á', '', '', '8 495-913-0168', ''],
    ['–ú–∞—Ä—Ç–∏–Ω—è—Ö–∏–Ω', '–í–∏—Ç–∞–ª–∏–π', '–ì–µ–Ω–Ω–∞–¥—å–µ–≤–∏—á', '–§–ù–°', '—Å–æ–≤–µ—Ç–Ω–∏–∫ –æ—Ç–¥–µ–ª–∞ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π', '', ''],
    ['–õ—É–∫–∏–Ω–∞', '–û–ª—å–≥–∞', '', '–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞', '–ú–∏–Ω—Ñ–∏–Ω', '+7 (495) 983-36-99 –¥–æ–±. 2926', 'Olga.Lukina@minfin.ru'],
    ['–ü–∞–Ω—å—à–∏–Ω', '–ê–ª–µ–∫—Å–µ–π', '–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á', '', '', '8(495)748-49-73', '1248@minfin.ru'],
    ['–õ–∞–≥—É–Ω—Ü–æ–≤', '–ò–≤–∞–Ω', '', '–ê–ª–µ–∫—Å–µ–µ–≤–∏—á', '–ú–∏–Ω—Ñ–∏–Ω', '+7 (495) 913-11-11 (–¥–æ–±. 0792)', ''],
    ['–õ–∞–≥—É–Ω—Ü–æ–≤', '–ò–≤–∞–Ω', '', '', '', '', 'Ivan.Laguntcov@minfin.ru'],
    ['–õ—É–∫–∏–Ω–∞', '–û–∫—Å–∞–Ω–∞', '–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞', '–ú–∏–Ω—Ñ–∏–Ω', '+7 (495) 983-36-99 –¥–æ–±. 2929', 'OLukina@minfin.ru']
]

# –£–¥–∞–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
rows = contacts[1:]

def fix_name_fields(row):
    """–ü—Ä–∏–≤–æ–¥–∏–º –§–ò–û –≤ –ø–æ—Ä—è–¥–æ–∫"""
    full_name = " ".join(row[:3])
    parts = full_name.split()
    lastname = firstname = surname = ""
    if len(parts) >= 1:
        lastname = parts[0]
    if len(parts) >= 2:
        firstname = parts[1]
    if len(parts) >= 3:
        surname = parts[2]
    return [lastname, firstname, surname]

def fix_phone(phone):
    """–ü—Ä–∏–≤–æ–¥–∏–º —Ç–µ–ª–µ—Ñ–æ–Ω –∫ —Ñ–æ—Ä–º–∞—Ç—É +7(999)999-99-99 –∏–ª–∏ +7(999)999-99-99 –¥–æ–±.9999"""
    if not phone:
        return ""
    # –û—á–∏—â–∞–µ–º —Å—Ç—Ä–æ–∫—É –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
    digits = re.sub(r'\D', '', phone)
    if len(digits) == 11 and digits[0] in ('7', '8'):
        digits = '7' + digits[1:]
    elif len(digits) == 10:
        digits = '7' + digits
    else:
        return phone

    main_number = digits[:10]
    ext = digits[10:] if len(digits) > 10 else ''

    formatted_phone = re.sub(r'(\d{1})(\d{3})(\d{3})(\d{2})(\d{2})', r'+7(\2)\3-\4-\5', main_number)

    if ext:
        formatted_phone += f' –¥–æ–±.{ext}'
    return formatted_phone

def merge_duplicates(rows):
    merged = defaultdict(list)

    for row in rows:
        # –ë–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –§–ò –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
        fixed_row = row.copy()
        name_fixed = fix_name_fields(fixed_row)
        lastname, firstname, surname = name_fixed
        key = (lastname, firstname)

        # –î–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ —Å–ø–∏—Å–æ–∫ –ø–æ–¥ –∫–ª—é—á–æ–º (—Ñ–∞–º–∏–ª–∏—è, –∏–º—è)
        merged[key].append(row)

    result = []
    for key, entries in merged.items():
        combined = ['', '', '', '', '', '', '']

        # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –ø–æ–ª—è –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
        for entry in entries:
            for i in range(len(entry)):
                if entry[i]:
                    combined[i] = entry[i]

        # –ü—Ä–∞–≤–∏–º –§–ò–û
        fixed = fix_name_fields(combined)
        combined[:3] = fixed

        # –ü—Ä–∞–≤–∏–º —Ç–µ–ª–µ—Ñ–æ–Ω
        combined[5] = fix_phone(combined[5])

        result.append(combined)

    return result

# –í—ã–ø–æ–ª–Ω—è–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
cleaned_contacts = merge_duplicates(rows)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ CSV —Ñ–∞–π–ª
with open("cleaned_contacts.csv", "w", encoding="utf-8", newline='') as f:
    writer = csv.writer(f)
    writer.writerow(['lastname', 'firstname', 'surname', 'organization', 'position', 'phone', 'email'])
    writer.writerows(cleaned_contacts)

print("–ö–æ–Ω—Ç–∞–∫—Ç—ã —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª 'cleaned_contacts.csv'")
```

---

## üìå –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:

### 1. **–§–ò–û**
- –ï—Å–ª–∏ –§–ò–û —Ä–∞–∑–±–∏—Ç–æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, `['–õ—É–∫–∏–Ω–∞', '–û–ª—å–≥–∞', '', '–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞', ...]`, —Ç–æ –º—ã –æ–±—ä–µ–¥–∏–Ω—è–µ–º –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞, —Ä–∞–∑–±–∏–≤–∞–µ–º –∏—Ö –∏ –ø–æ–ª—É—á–∞–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ `lastname`, `firstname`, `surname`.

### 2. **–¢–µ–ª–µ—Ñ–æ–Ω**
- –ü—Ä–∏–≤–æ–¥–∏—Ç –Ω–æ–º–µ—Ä –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É:
  - `+7(999)999-99-99`
  - –∏–ª–∏ `+7(999)999-99-99 –¥–æ–±.9999`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–±–∞–≤–æ—á–Ω—ã–µ –Ω–æ–º–µ—Ä–∞, —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–±–µ–ª—ã, —Å–∫–æ–±–∫–∏ –∏ —Ç.–ø.

### 3. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**
- –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ –∫–ª—é—á—É `(lastname, firstname)`
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–µ–ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π.

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

| lastname   | firstname | surname     | organization | position | phone                   | email                     |
|------------|-----------|-------------|--------------|----------|-------------------------|---------------------------|
| –õ—É–∫–∏–Ω–∞     | –û–ª—å–≥–∞     | –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞| –ú–∏–Ω—Ñ–∏–Ω       | ...      | +7(495)983-36-99 –¥–æ–±.2926 | Olga.Lukina@minfin.ru     |
| –õ—É–∫–∏–Ω–∞     | –û–∫—Å–∞–Ω–∞    | –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞| –ú–∏–Ω—Ñ–∏–Ω       | ...      | +7(495)983-36-99 –¥–æ–±.2929 | OLukina@minfin.ru         |
| –õ–∞–≥—É–Ω—Ü–æ–≤   | –ò–≤–∞–Ω      | –ê–ª–µ–∫—Å–µ–µ–≤–∏—á  | –ú–∏–Ω—Ñ–∏–Ω       | ...      | +7(495)913-11-11 –¥–æ–±.0792 | Ivan.Laguntcov@minfin.ru  |

---

–•–æ—á–µ—à—å –≤–µ—Ä—Å–∏—é —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —á—Ç–µ–Ω–∏–µ–º CSV-—Ñ–∞–π–ª–∞? –ù–∞–ø–∏—à–∏ ‚Äî —Å–¥–µ–ª–∞—é!